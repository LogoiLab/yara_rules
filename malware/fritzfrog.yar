import "hash"

rule fritzfrog_ssh_key {

  meta:
    author = "Chad Baxter"
    author_email = "cbaxter@mail.umw.edu"
    date = "2020-08-19"
    updated = "2020-08-19"
    description = "The SSH key used by the FritzFrog P2P worm"
    malware_type = "botnet"
    malware_family = "Linux/FritzFrog.A"
    actor_type = "Advanced"
    actor_group = "Unknown"

  strings:
    $key = "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDJYZIsncBTFc+iCRHXkeGfFA67j+kUVf7h/IL+sh0RXJn7yDN0vEXz7ig73hC//2/71sND+x+Wu0zytQhZxrCPzimSyC8FJCRtcqDATSjvWsIoI4j/AJyKk5k3fCzjPex3moc48TEYiSbAgXYVQ62uNhx7ylug50nTcUH1BNKDiknXjnZfueiqAO1vcgNLH4qfqIj7WWXu8YgFJ9qwYmwbMm+S7jYYgCtD107bpSR7/WoXSr1/SJLGX6Hg1sTet2USiNevGbfqNzciNxOp08hHQIYp2W9sMuo02pXj9nEoiximR4gSKrNoVesqNZMcVA0Kku01uOuOBAOReN7KJQBt"

  condition:
    all of them

}

rule fritzfrog_files {

  meta:
    author = "Chad Baxter"
    author_email = "cbaxter@mail.umw.edu"
    date = "2020-08-19"
    updated = "2020-08-19"
    description = "The executable files of the FritzFrog P2P worm"

  strings:
    $fname0 = "nginx"
    $fname1 = "ifconfig"
    $fname2 = "libexec"
    $fname3 = "php_fpm"
    $fname4 = "php-fpm"

  condition:
    any of them and
    hash.sha256(0, filesize) ==
    "103B8404DC64C9A44511675981A09FD01395EE837452D114F1350C295357C046" or
    hash.sha256(0, filesize) ==
    "30C150419000D27DAFCD5D00702411B2B23B0F5D7E4D0CC729A7D63B2E460A01" or
    hash.sha256(0, filesize) ==
    "9384B9E39334479194AACB53CB25ACE289B6AFE2E41BDC8619B2D2CAE966B948" or
    hash.sha256(0, filesize) ==
    "39AB194DC7A7BA65615A30D99ED8845EE00AD19F2AC1236FBD71A671F7FA4C5A" or
    hash.sha256(0, filesize) ==
    "D1E82D4A37959A9E6B661E31B8C8C6D2813C93AC92508A2771B2491B04EA2485" or
    hash.sha256(0, filesize) ==
    "0AB8836EFCAA62C7DAAC314E0B7AB1679319B2901578FD9E95EC3476B4C1A732" or
    hash.sha256(0, filesize) ==
    "5FB29FB0136978B9CCF60750AF09CEC74A257A0CA9C47159CA74DBBA21FBCC59" or
    hash.sha256(0, filesize) ==
    "D9E8D9187FDD5A6682CC3B55076FE48BC8743487EB4731F669A7D591D3015CE5" or
    hash.sha256(0, filesize) ==
    "041BC20CA8AC3161098CBC976E67E3C0F1B672AD36ECBE22FD21CBD53BCAA742" or
    hash.sha256(0, filesize) ==
    "7745B070943E910E8807E3521AC7B7A01401D131BF6C18A63433F8177ED539A6" or
    hash.sha256(0, filesize) ==
    "8C094313B1D4236AE3F630D93E8037B0A9D38DF716D5D7AED5B871DEA0DC1445" or
    hash.sha256(0, filesize) ==
    "90B61CC77BB2D726219FD00AE2D0ECDF6F0FE7078529E87B7EC8E603008232D5" or
    hash.sha256(0, filesize) ==
    "985FFEE662969825146D1B465D068EA4F5F01990D13827511415FD497CF9DB86" or
    hash.sha256(0, filesize) ==
    "23E390E6531623C1E9E09B1EAF807D501D1A01E45184B7D3FFC4EEED955B0C6D" or
    hash.sha256(0, filesize) ==
    "6FE6808B9CFE654F526108EC61CB5211BB6601D28E192CADF06102073B54F69C" or
    hash.sha256(0, filesize) ==
    "453468B86856665F2CC0E0E71668C0B6AAC8B14326C623995BA5963F22257619" or
    hash.sha256(0, filesize) ==
    "7F18E5B5B7645A80A0D44ADF3FECDAFCBF937BFE30A4CFB965A1421E034996DD" or
    hash.sha256(0, filesize) ==
    "001EB377F0452060012124CB214F658754C7488CCB82E23EC56B2F45A636C859" or
    hash.sha256(0, filesize) ==
    "2378E76ABA1AD6E0C937FB39989217BF0DE616FDAD4726C0F4233BF5414CDE86" or
    hash.sha256(0, filesize) ==
    "3205603282A636979A55AA1E1BE518CD3ADCBBE491745D996CEB4B5A4DECE0C5"

}
